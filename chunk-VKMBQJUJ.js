import{a as Be}from"./chunk-3DWB6QZU.js";import"./chunk-FK6H3RFT.js";import{a as Re,b as qe,c as Ge,k as Ve}from"./chunk-M6DGHITQ.js";import{a as je}from"./chunk-3TIWJO7N.js";import{a as Fe,b as Te,c as Ae}from"./chunk-U4VTSWDG.js";import{a as de}from"./chunk-CNP2COBP.js";import"./chunk-KDNFE22G.js";import"./chunk-DQBQ7EW5.js";import{a as Q}from"./chunk-IMUJMABS.js";import{b as S,d as Pe,e as ye,f as Ie,g as ke,h as Ne}from"./chunk-T2AQUXFH.js";import{A as Oe,C as xe,D as we,Q as De,R as Se,S as D,T as Ee,b as ie,e as ne,i as re,j as me,l as se,m as le,r as fe,s as ue,t as _e,u as ge,v as Ce,w as he,x as Me,y as ve,z as be}from"./chunk-Q23MXH7B.js";import"./chunk-2PPFUFFT.js";import{b as x,f as ae,l as w}from"./chunk-RYRDEO54.js";import{b as ce}from"./chunk-I3X2TQNM.js";import{k as pe}from"./chunk-RF64FGT2.js";import"./chunk-QRFH67T7.js";import"./chunk-FD6YJ6N6.js";import{S as te,ba as oe}from"./chunk-3IDK2O2Y.js";import{b as U,d as b,g as J,h as K,i as O,k as c,m as W,o as X,p as Y,s as Z,t as ee}from"./chunk-FQ7V5Y7D.js";import{aa as L}from"./chunk-E2AUU6GZ.js";import{Ac as z,Bc as $,Kb as l,Pb as R,Qb as q,Rb as G,Sb as V,Tb as i,Ub as a,Vb as f,Wb as _,Xb as g,Zb as k,bb as m,cb as T,ea as p,fc as u,hc as M,kb as A,ma as y,mc as j,na as I,nc as B,oc as H,rb as h,sc as N,tc as n,uc as v,vc as F,yb as d}from"./chunk-YR66D3FA.js";import"./chunk-QMQTSFHS.js";import{a as P}from"./chunk-EQDQRRRY.js";var E=class t{constructor(e){this.MatDialogRef=e}dialogRef=p(S);onNoClick(){this.dialogRef.close(!1)}gerarAgora(){this.dialogRef.close(!0)}static \u0275fac=function(o){return new(o||t)(T(S))};static \u0275cmp=h({type:t,selectors:[["app-gerar-etiqueta"]],decls:9,vars:0,consts:[["mat-dialog-title",""],["mat-button","","mat-dialog-close","",3,"click"],["mat-button","","mat-dialog-close","","cdkFocusInitial","",3,"click"]],template:function(o,r){o&1&&(i(0,"h2",0),n(1,"Gerar Etiquetas de Impress\xE3o"),a(),i(2,"mat-dialog-content"),n(3,` Gostaria de gerar as etiquetas de impress\xE3o agora? Clique em "Sim" para prosseguir. Se preferir, voc\xEA pode fechar esta janela e imprimir as etiquetas mais tarde na lista de amostras pendentes.
`),a(),i(4,"mat-dialog-actions")(5,"button",1),u("click",function(){return r.onNoClick()}),n(6,"N\xE3o"),a(),i(7,"button",2),u("click",function(){return r.gerarAgora()}),n(8," Sim "),a()())},dependencies:[w,x,Ne,ye,Ie,ke],encapsulation:2})};var Ue=()=>[5];function Je(t,e){if(t&1&&(i(0,"mat-option",11),n(1),a()),t&2){let o=e.$implicit;l("value",o.tipo),m(),v(o.tipo)}}function Ke(t,e){if(t&1){let o=k();i(0,"button",29),u("click",function(){y(o);let s=M();return I(s.addAmostra())}),i(1,"mat-icon"),n(2,"add"),a()()}if(t&2){let o=M();l("disabled",!o.amostraForm.valid)}}function We(t,e){t&1&&(i(0,"th",30),n(1,"Num."),a())}function Xe(t,e){if(t&1&&(i(0,"td",31),n(1),a()),t&2){let o=e.$implicit;m(),F(" ",o.num||o.num," ")}}function Ye(t,e){t&1&&(i(0,"th",30),n(1,"Identifica\xE7ao"),a())}function Ze(t,e){if(t&1&&(i(0,"td",31),n(1),a()),t&2){let o=e.$implicit;m(),v(o.nome_amostra)}}function et(t,e){t&1&&(i(0,"th",30),n(1,"Data"),a())}function tt(t,e){if(t&1&&(i(0,"td",31),n(1),a()),t&2){let o=e.$implicit;m(),v(o.data_amostra)}}function ot(t,e){t&1&&(i(0,"th",30),n(1,"Ensaios"),a())}function at(t,e){if(t&1&&(i(0,"td",31),n(1),a()),t&2){let o=e.$implicit;m(),F(" ",o.ensaios_solicitados," ")}}function it(t,e){t&1&&f(0,"tr",32)}function nt(t,e){t&1&&f(0,"tr",33)}function rt(t,e){if(t&1&&(i(0,"form",25)(1,"mat-form-field")(2,"mat-label"),n(3,"Observa\xE7\xE3o:"),a(),f(4,"textarea",34),a()()),t&2){let o=M();l("formGroup",o.obsForm)}}var He=class t{paginator;#t=p(Pe);#o=p(de);#a=p(je);#e=p(Q);#i=A({});#n=p(Ae);#r=p(Be);ensaios=new c("");listaDeEnsaios=[];amostras={};amostraForm=new O({nome_amostra:new c("",b.required),data_amostra:new c("",b.required),ensaios_solicitados:new c([],b.required)});obsForm=new O({observacao:new c("")});profileForm=new O({id:new c(""),name:new c(""),email:new c(""),phone:new c("")});ngOnInit(){this.#o.httpCheckUser().subscribe(e=>{this.#i.set(e),this.profileForm.patchValue({id:e._id,name:e.name,email:e.email,phone:e.phone})}),this.#n.httpListarTipoDeAnalise().subscribe(e=>{e&&e.tipo_de_analise?this.listaDeEnsaios=e.tipo_de_analise:this.#e.error(e.message)})}ngAfterViewInit(){this.dataSource.paginator=this.paginator}displayedColumns=["num","nome_amostra","data_amostra","ensaios_solicitados"];dataSource=new we(Object.entries(this.amostras).map(([e,o])=>P({num:e},o)));addAmostra(){let o=new Date(this.amostraForm.value.data_amostra).toLocaleDateString("pt-BR"),r={nome_amostra:this.amostraForm.value.nome_amostra,data_amostra:o,ensaios_solicitados:this.amostraForm.value.ensaios_solicitados.join(", ")},s=Object.keys(this.amostras).length+1;this.amostras[s]=r,this.dataSource.data=Object.entries(this.amostras).map(([C,ze])=>P({num:C},ze)),this.amostraForm.reset()}enviarOs(){Object.keys(this.amostras).length>0?this.#a.httpCriarOrdemDeServico(this.amostras,this.obsForm.value.observacao).subscribe({next:e=>{this.#e.success("Ordem de servi\xE7o criada com sucesso!"),this.amostraForm.reset(),this.amostras={},this.dataSource.data=[],this.dialogGerarEtiquetas(e.ordemDeServico)},error:e=>this.#e.error(e.error.message)}):this.#e.info("Ordem de servi\xE7o n\xE3o cont\xE9m 'amostras'!")}dialogGerarEtiquetas(e){this.#t.open(E,{}).afterClosed().subscribe(r=>{r&&this.#r.gerarPDFEtiqueta(e)})}static \u0275fac=function(o){return new(o||t)};static \u0275cmp=h({type:t,selectors:[["app-nova-os"]],viewQuery:function(o,r){if(o&1&&j(D,5),o&2){let s;B(s=H())&&(r.paginator=s.first)}},features:[z([te()])],decls:48,vars:11,consts:[["picker",""],["obss",""],[1,"form-container"],[1,"formulario"],[1,"tabela-header",3,"formGroup"],[1,"tabela-header-row1"],["type","text","matInput","","formControlName","nome_amostra"],["matInput","","formControlName","data_amostra",3,"matDatepicker"],["matIconSuffix","",3,"for"],[1,"tabela-header-row2"],["multiple","","formControlName","ensaios_solicitados"],[3,"value"],["mat-fab","",3,"disabled","click",4,"ngIf"],[1,"tabela-container"],["mat-table","",1,"table-wrapper",3,"dataSource"],["matColumnDef","num"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","nome_amostra"],["matColumnDef","data_amostra"],["matColumnDef","ensaios_solicitados"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","","aria-label","Selecione as amostras",1,"sticky-paginator",3,"pageSizeOptions"],[1,"formulario-footer"],[3,"formGroup"],[1,"form-action"],[3,"labelPosition"],["mat-raised-button","",3,"click"],["mat-fab","",3,"click","disabled"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row",""],["formControlName","observacao","matInput","","placeholder","Ex. Informa\xE7\xF5es sobre envio ou coleta..."]],template:function(o,r){if(o&1){let s=k();i(0,"div",2)(1,"mat-card",3)(2,"form",4)(3,"div",5)(4,"mat-form-field")(5,"mat-label"),n(6,"Identifica\xE7ao"),a(),f(7,"input",6),a(),i(8,"mat-form-field")(9,"mat-label"),n(10,"Data da amostra"),a(),f(11,"input",7)(12,"mat-datepicker-toggle",8)(13,"mat-datepicker",null,0),a()(),i(15,"div",9)(16,"mat-form-field")(17,"mat-label"),n(18,"Ensaios"),a(),i(19,"mat-select",10),G(20,Je,2,2,"mat-option",11,q),a()(),d(22,Ke,3,1,"button",12),a()()(),i(23,"div",13)(24,"table",14),_(25,15),d(26,We,2,0,"th",16)(27,Xe,2,1,"td",17),g(),_(28,18),d(29,Ye,2,0,"th",16)(30,Ze,2,1,"td",17),g(),_(31,19),d(32,et,2,0,"th",16)(33,tt,2,1,"td",17),g(),_(34,20),d(35,ot,2,0,"th",16)(36,at,2,1,"td",17),g(),d(37,it,1,0,"tr",21)(38,nt,1,0,"tr",22),a(),f(39,"mat-paginator",23),a(),i(40,"mat-card",24),d(41,rt,5,1,"form",25),i(42,"div",26)(43,"mat-checkbox",27,1),n(45,"Adicionar observa\xE7\xF5es ?"),a(),i(46,"button",28),u("click",function(){return y(s),I(r.enviarOs())}),n(47,"Enviar OS"),a()()()()}if(o&2){let s=N(14),C=N(44);m(2),l("formGroup",r.amostraForm),m(9),l("matDatepicker",s),m(),l("for",s),m(8),V(r.listaDeEnsaios),m(2),l("ngIf",r.amostraForm.valid),m(2),l("dataSource",r.dataSource),m(13),l("matHeaderRowDef",r.displayedColumns),m(),l("matRowDefColumns",r.displayedColumns),m(),l("pageSizeOptions",$(10,Ue)),m(2),R(C.checked?41:-1),m(2),l("labelPosition","before")}},dependencies:[ee,W,U,J,K,X,Y,Z,me,re,ie,ne,le,se,ce,fe,xe,_e,Me,ge,ue,ve,Ce,he,be,Oe,w,x,ae,Ee,D,Se,De,oe,pe,Ve,Re,qe,Ge,L,Te,Fe],styles:["[_nghost-%COMP%]   mat-card[_ngcontent-%COMP%]{border-radius:1px}[_nghost-%COMP%]   .form-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex-grow:1;overflow:hidden;height:100%;gap:2px}[_nghost-%COMP%]   .formulario[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column;flex-wrap:wrap;padding:10px;gap:10px}[_nghost-%COMP%]   .tabela-header[_ngcontent-%COMP%]{margin:20px 0;display:flex;flex-direction:column;gap:20px}[_nghost-%COMP%]   .tabela-header-row1[_ngcontent-%COMP%], [_nghost-%COMP%]   .tabela-header-row2[_ngcontent-%COMP%]{display:flex;gap:20px;align-items:center}[_nghost-%COMP%]   .tabela-header-row2[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:50px;height:50px;opacity:.8}[_nghost-%COMP%]   .tabela-header-row2[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:var(--blue-10)}[_nghost-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   .tabela-container[_ngcontent-%COMP%]{flex-grow:1;display:flex;flex-direction:column;overflow:auto}[_nghost-%COMP%]   .table-wrapper[_ngcontent-%COMP%]{width:100%;overflow-y:auto;table-layout:fixed;border-spacing:0;border-collapse:collapse}[_nghost-%COMP%]   th.mat-header-cell[_ngcontent-%COMP%]{position:sticky;top:0;background-color:#fff;z-index:1;box-shadow:0 2px 4px #0000001a}[_nghost-%COMP%]   th[_ngcontent-%COMP%]{position:sticky;top:0;z-index:1}[_nghost-%COMP%]   .sticky-paginator[_ngcontent-%COMP%]{position:sticky;bottom:0;z-index:2;background-color:#fff}[_nghost-%COMP%]   .formulario-footer[_ngcontent-%COMP%]{margin-top:auto;width:100%;padding:10px 20px}[_nghost-%COMP%]   .formulario-footer[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{display:flex;flex-direction:column}[_nghost-%COMP%]   .formulario-footer[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{margin:10px 0}[_nghost-%COMP%]   .form-action[_ngcontent-%COMP%]{margin:10px 20px;display:flex;justify-content:space-between}[_nghost-%COMP%]   .form-action[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border-radius:5px}[_nghost-%COMP%]     .mat-mdc-form-field-subscript-wrapper{display:none}@media (max-width: 768px){[_nghost-%COMP%]   .tabela-header-row1[_ngcontent-%COMP%]{flex-direction:column}}"]})};export{He as NovaOsComponent};
