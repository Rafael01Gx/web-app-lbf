import{a as ae,b as ie,c as re,d as oe,e as ne,f as me,g as le,h as se,i as ce,j as de,k as pe}from"./chunk-M6DGHITQ.js";import{a as ue}from"./chunk-3TIWJO7N.js";import{a as F}from"./chunk-IMUJMABS.js";import{b as U,c as W,e as X,f as Y,g as Z,h as ee,i as te}from"./chunk-T2AQUXFH.js";import{Q as K,R as Q,b as q,e as B,i as $,j as L,l as H,m as J}from"./chunk-Q23MXH7B.js";import{b as G,l as V}from"./chunk-RYRDEO54.js";import{S as R,ba as j}from"./chunk-3IDK2O2Y.js";import{b as x,d as p,g as y,h as I,i as h,k as c,m as P,o as w,p as z,s as N,t as T}from"./chunk-FQ7V5Y7D.js";import{pa as f}from"./chunk-E2AUU6GZ.js";import{Ac as k,Kb as s,Pb as O,Qb as E,Rb as A,Sb as b,Tb as a,Ub as e,Vb as d,bb as m,cb as u,ea as g,fc as v,hc as _,rb as M,sc as D,tc as o,uc as S,yb as C}from"./chunk-YR66D3FA.js";function ve(n,l){if(n&1&&(a(0,"mat-option",13),o(1),e()),n&2){let t=l.$implicit;s("value",t),m(),S(t)}}function _e(n,l){if(n&1&&(a(0,"form",6)(1,"mat-form-field",10)(2,"mat-label"),o(3,"Num. Ordem de Servi\xE7o"),e(),d(4,"input",11),e(),a(5,"mat-form-field",10)(6,"mat-label"),o(7,"Status"),e(),a(8,"mat-select",12),A(9,ve,2,2,"mat-option",13,E),e()()()),n&2){let t=_();s("formGroup",t.osStatusForm),m(9),b(t.opcoes_status)}}function De(n,l){if(n&1&&(a(0,"form",6)(1,"mat-form-field",10)(2,"mat-label"),o(3,"Num. Ordem de Servi\xE7o"),e(),d(4,"input",14),e(),a(5,"mat-form-field",10)(6,"mat-label"),o(7,"Data da recep\xE7\xE3o"),e(),d(8,"input",15)(9,"mat-datepicker-toggle",16)(10,"mat-datepicker",null,0),e(),a(12,"mat-form-field",10)(13,"mat-label"),o(14,"Prazo estimado"),e(),a(15,"mat-date-range-input",17),d(16,"input",18)(17,"input",19),e(),d(18,"mat-datepicker-toggle",16),a(19,"mat-date-range-picker",null,1)(21,"mat-date-range-picker-actions")(22,"button",20),o(23,"Cancelar"),e(),a(24,"button",21),o(25,"Aplicar"),e()()()(),a(26,"mat-form-field",10)(27,"mat-label"),o(28,"Observa\xE7\xE3o"),e(),d(29,"textarea",22),e()()),n&2){let t=D(11),i=D(20),r=_();s("formGroup",r.programarAnaliseForm),m(4),s("value",r.data._id),m(4),s("matDatepicker",t),m(),s("for",t),m(6),s("rangePicker",i),m(3),s("for",i)}}var fe=class n{constructor(l,t,i){this.dialogRef=l;this.data=t;this.datePipe=i;this.ordem_de_servico=t}#e=g(F);#t=g(ue);programar_analise=!1;ngOnInit(){this.osStatusForm.patchValue({numeroOs:this.data.numeroOs}),this.data.data_recepcao&&(this.programar_analise=!0,this.programarAnaliseForm.patchValue({numeroOs:this.data.numeroOs}))}ordem_de_servico;osStatusForm=new h({numeroOs:new c(""),status:new c("",p.required)});programarAnaliseForm=new h({numeroOs:new c(""),data_recepcao:new c("",p.required),data_inicio:new c("",p.required),data_fim:new c("",p.required),observacao:new c("")});onNoClick(){this.dialogRef.close(!1)}formatDate(l){return this.datePipe.transform(l,"dd/MM/yyyy")||""}httpEditarOrdemDeServico(){let l=this.formatDate(this.programarAnaliseForm.value.data_recepcao?new Date(this.programarAnaliseForm.value.data_recepcao):null),t=this.formatDate(this.programarAnaliseForm.value.data_inicio?new Date(this.programarAnaliseForm.value.data_inicio):null),i=this.formatDate(this.programarAnaliseForm.value.data_fim?new Date(this.programarAnaliseForm.value.data_fim):null);try{let r={_id:this.data._id};this.osStatusForm.valid&&(r.status=this.osStatusForm.value.status),this.programarAnaliseForm.valid&&(r.prazo_inicio_fim=`${t} - ${i}`,r.data_recepcao=l,r.observacao_adm=this.programarAnaliseForm.value.observacao,r.status="Em Execu\xE7\xE3o"),this.#t.httpEditarOrdemDeServico(r).subscribe({next:()=>{this.#e.success("Status atualizado com sucesso!"),this.#e.info(this.osStatusForm.value.status),this.dialogRef.close(!0)},error:ge=>this.#e.error(ge.error.message)}),this.dialogRef.close(!0)}catch(r){console.log(r),this.#e.error("Ocorreu um erro ao atualizar a 'Ordem de Servi\xE7o'")}}opcoes_status=["Autorizada","Cancelada"];static \u0275fac=function(t){return new(t||n)(u(U),u(W),u(f))};static \u0275cmp=M({type:n,selectors:[["app-autorizar-os"]],features:[k([R(),f])],decls:12,vars:4,consts:[["picker",""],["rangePicker",""],[1,"modal"],["mat-dialog-title",""],[1,"form-container"],["mat-dialog-content","",2,"width","100%"],[3,"formGroup"],["mat-dialog-actions",""],["mat-button","",3,"click"],["mat-button","",3,"click","mat-dialog-close","disabled"],[2,"width","100%"],["type","text","matInput","","formControlName","numeroOs","readonly",""],["formControlName","status"],[3,"value"],["type","text","matInput","","formControlName","numeroOs","readonly","",3,"value"],["matInput","","formControlName","data_recepcao",3,"matDatepicker"],["matIconSuffix","",3,"for"],[3,"rangePicker"],["matStartDate","","placeholder","Data Inicio","formControlName","data_inicio"],["matEndDate","","placeholder","Data Fim","formControlName","data_fim"],["mat-button","","matDateRangePickerCancel",""],["mat-raised-button","","matDateRangePickerApply",""],["formControlName","observacao","matInput","","placeholder","Ex. Ordem de prioridade..."]],template:function(t,i){t&1&&(a(0,"div",2)(1,"h1",3),o(2),e(),a(3,"div",4)(4,"div",5),C(5,_e,11,1,"form",6)(6,De,30,6,"form",6),e()(),a(7,"div",7)(8,"button",8),v("click",function(){return i.onNoClick()}),o(9,"Cancelar"),e(),a(10,"button",9),v("click",function(){return i.httpEditarOrdemDeServico()}),o(11,"Salvar"),e()()()),t&2&&(m(2),S(i.programar_analise?"Programar An\xE1lise":"Editar Status - Ordem de Servi\xE7o"),m(3),O(i.programar_analise?6:5),m(5),s("mat-dialog-close",i.data)("disabled",!(i.programarAnaliseForm.valid||i.osStatusForm.valid)))},dependencies:[L,$,q,B,J,H,te,X,Y,ee,Z,N,P,x,y,I,Q,K,j,V,G,T,w,z,pe,ae,ie,re,me,oe,ne,le,de,ce,se],styles:[".mat-mdc-dialog-surface{border-radius:5px!important}[_nghost-%COMP%]   .modal[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column;align-items:center;justify-content:center}[_nghost-%COMP%]   .modal[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]{width:100%;display:flex;flex-flow:column}[_nghost-%COMP%]   .modal[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .check-box[_ngcontent-%COMP%]{align-items:baseline;justify-content:space-around;display:flex;width:100%}"],changeDetection:0})};export{fe as a};
